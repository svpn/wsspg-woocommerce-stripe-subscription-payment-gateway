!function(a){"use strict";var b={form:a("form.checkout, form#order_review, form#add_payment_method"),pkey:a("#wsspg-cc-fieldset").data("pkey"),init:function(){a(b.form).on("click","#place_order",this.on_click).append("<input type='hidden' name='wsspg-data' value='' />")},on_click:function(c){var d=a("input[name=payment_method]:checked").val();if("wsspg"!==d)return!0;var e=a('input[name="wc-wsspg-payment-token"]:checked').val();if(e&&"new"!==e){var f={method:"saved",token:e,save:null,error:null};a("input[name=wsspg-data]").val(JSON.stringify(f,null)),b.form.submit()}else{if(c.preventDefault(),"function"==typeof Stripe)return Stripe.setPublishableKey(b.pkey),Stripe.card.createToken({number:a("#wsspg-cc-number").val(),cvc:a("#wsspg-cc-cvc").val(),exp_month:a("#wsspg-cc-exp-month").val(),exp_year:a("#wsspg-cc-exp-year").val(),name:a("#billing_first_name").val()+" "+a("#billing_last_name").val()+" <"+a("#billing_email").val()+">",address_line1:a("#billing_address_1").val(),address_line2:a("#billing_address_2").val(),address_city:a("#billing_city").val(),address_state:a("#billing_state").val(),address_zip:a("#billing_postcode").val(),address_country:a("#billing_country").val()},b.handle_response),!1;var f={method:null,token:null,save:null,error:"Error processing checkout. Please try again."};a("input[name=wsspg-data]").val(JSON.stringify(f,null)),b.form.submit()}},handle_response:function(c,d){var e={method:"inline",token:null,save:a("#wc-wsspg-new-payment-method").is(":checked"),error:null};d.error?e.error=d.error.message:e.token=d,a("input[name=wsspg-data]").val(JSON.stringify(e,null)),b.form.submit()}};b.init()}(jQuery);
